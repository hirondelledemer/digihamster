"use strict";(self.webpackChunkdigihamster=self.webpackChunkdigihamster||[]).push([[9073],{"./src/app/components/StaleIndicator/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>StaleIndicator_StaleIndicator});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),differenceInCalendarDays=__webpack_require__("./node_modules/date-fns/differenceInCalendarDays.mjs"),date_date=__webpack_require__("./src/app/utils/date/date.ts");const DinosaurIcon=props=>(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512","data-testid":"dinosaur-icon",...props,children:(0,jsx_runtime.jsx)("path",{d:"m236.375 34.5-18.53 2.406 5.06 39.407c-9.114 1.973-18.22 4.657-27.28 8.062l-9.5-40.156-18.188 4.31 10.25 43.345a218.543 218.543 0 0 0-25.093 14.344l-17.28-42.876L118.5 70.31l19.03 47.22a206.258 206.258 0 0 0-14.25 12.468L89.47 89.625l-14.345 12 35.22 42.063a195.014 195.014 0 0 0-12.97 16.78L53.47 133.5l-9.782 15.938 43.874 26.906a193.797 193.797 0 0 0-9.812 20.53l-47.53-12.81-4.845 18.06L71.5 214.532a200.305 200.305 0 0 0-7.344 36.345l-39.656-2.25-1.03 18.688 39.56 2.218a207.24 207.24 0 0 0 2.47 35.19L31.375 311l3.375 18.375 34.47-6.344c2.885 11.524 6.74 22.782 11.56 33.595l-26.31 11.97 7.75 17 27-12.283A192.58 192.58 0 0 0 110 403.126l-20.53 16.813 11.843 14.468 21.5-17.625a184.811 184.811 0 0 0 29.406 23.126L141.53 456l15.564 10.344 11.437-17.22c11.12 5.558 23.014 10.1 35.626 13.47l3.563-17.72c-10.315-2.77-20.055-6.39-29.19-10.812l7.47-11.25-15.563-10.343-8.28 12.467c-9.12-5.807-17.506-12.456-25.157-19.78l13.906-11.407-11.844-14.438-14.843 12.157a177.534 177.534 0 0 1-18-25.908l22.5-10.25-7.75-17-23.19 10.563a188.384 188.384 0 0 1-10.218-29.22l32.313-5.967-3.375-18.375-32.72 6.03a188.112 188.112 0 0 1-2.25-30.78l40.032 2.25 1.063-18.657-39.97-2.25c.73-6.54 1.805-13.07 3.25-19.53 4.226.572 9.16 1.176 15.064 1.843 14.326 1.616 32.835 3.446 51.155 5.186 29.98 2.848 49.638 4.533 59.375 5.375l-33.063 72.345-5.78 12.656 1.343.064L234.563 365l9.406-16.156-29.94-17.375 51.782 2.092.75-18.687-49.343-2 33.593-13.22-6.844-17.405-35.407 13.938L234 240.53l5.5-12.06-13.22-1.126s-35.88-3.062-72.405-6.53c-18.263-1.736-36.696-3.565-50.813-5.158-4.618-.52-8.52-1.014-12.03-1.47 9.83-29.017 27.474-56.23 53.812-78.5l20.937 52 17.345-7-22.875-56.75c.296-.202.578-.42.875-.624a207.016 207.016 0 0 1 21.47-12.812l18.874 79.906 18.186-4.28-19.72-83.5c8.432-3.326 16.87-5.95 25.314-7.876l11.78 91.75 18.532-2.375-11.875-92.53c8.964-1.012 17.896-1.247 26.75-.814l3 96.19 18.688-.595-.344-11.25 34.22 39.28-37.28 17.064 7.78 17 32.313-14.782-15.688 32.343 16.813 8.19L353.344 226l2.72-5.563-4.064-4.656-41.375-47.468 50.53-47.843c23.78 15.006 45.428 35.18 63.533 59.343-23.814 6.14-44.022 24.153-50.688 53.718l47 103.064 16.875-2.406-26.938-68.625 17.407-6.844 28.562 72.75 34.813-5-8.408-138.626c-11.76-6.55-24.637-9.992-37.312-10.375a280.675 280.675 0 0 0-14.47-19.19l18.564-18.686-13.25-13.156-17.72 17.812a260.514 260.514 0 0 0-15.78-15.28l18.125-27.314-15.595-10.312-17 25.656a238.895 238.895 0 0 0-18.656-12.906l10.56-31.844-17.75-5.875-9.374 28.28a216.306 216.306 0 0 0-21.906-9.75l3.156-33.686-18.625-1.75-2.75 29.5a195.525 195.525 0 0 0-24.905-5.126l-.938-30.188L269 44.22l.875 27.936c-1.664-.064-3.33-.105-5-.125-1.19-.013-2.37-.007-3.563 0-6.633.05-13.29.455-19.968 1.22l-4.97-38.75zm52.844 58.22a179.002 179.002 0 0 1 22.53 5.155l-4.438 47.406.407.032-16.376 15.5-2.125-68.093zm40.717 11.56a198.143 198.143 0 0 1 14.25 6.532l-16.312 15.438 2.063-21.97zM441.5 195.5c.786-.023 1.572.006 2.375.063 12.852.9 22.34 11.843 21.438 24.687-.902 12.84-11.836 22.34-24.688 21.438-12.852-.902-22.34-11.848-21.438-24.688.845-12.037 10.52-21.152 22.313-21.5zM328.25 439.563a292.03 292.03 0 0 1-15.625 4.28l4 18.282c5.63-1.356 11.322-2.9 17.094-4.656l-5.47-17.908zm-33.906 8.093a238.418 238.418 0 0 1-20.97 2.656l.376 18.532a250.825 250.825 0 0 0 24.563-2.938l-3.97-18.25zM226 448.75l-3.594 17.78c10.464 1.76 21.356 2.75 32.656 2.876l-.375-18.344c-9.96-.06-19.515-.87-28.687-2.312z"})}),icons_DinosaurIcon=DinosaurIcon;DinosaurIcon.__docgenInfo={description:"",methods:[],displayName:"DinosaurIcon",props:{className:{required:!1,tsType:{name:"string"},description:""}}};var utils=__webpack_require__("./src/app/components/utils/index.ts"),tooltip=__webpack_require__("./src/app/components/ui/tooltip.tsx");const StaleIndicator=({date,className})=>{const staleDays=(0,differenceInCalendarDays.m)((0,date_date.tB)(),date),color=(0,react.useMemo)((()=>staleDays>21?"fill-red-500":staleDays>14?"fill-amber-500":staleDays>7?"fill-gray-200":null),[staleDays]);return color?(0,jsx_runtime.jsx)(tooltip.Bc,{children:(0,jsx_runtime.jsxs)(tooltip.m_,{delayDuration:0,children:[(0,jsx_runtime.jsx)(tooltip.k$,{children:(0,jsx_runtime.jsx)(icons_DinosaurIcon,{className:(0,utils.cn)("h-4 w-4",color,className)})}),(0,jsx_runtime.jsx)(tooltip.ZI,{children:staleDays})]})}):null},StaleIndicator_StaleIndicator=StaleIndicator;StaleIndicator.__docgenInfo={description:"",methods:[],displayName:"StaleIndicator",props:{className:{required:!1,tsType:{name:"string"},description:""},date:{required:!0,tsType:{name:"number"},description:""}}}},"./src/app/components/TaskActions/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>TaskActions});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),context_menu=__webpack_require__("./src/app/components/ui/context-menu.tsx"),use_edit_task=__webpack_require__("./src/app/utils/hooks/use-edit-task.tsx"),sheet=__webpack_require__("./src/app/components/ui/sheet.tsx"),RichTextEditor=__webpack_require__("./src/app/components/RichTextEditor/index.ts"),rte_hook=__webpack_require__("./src/app/utils/rte/rte-hook.ts"),ui_button=__webpack_require__("./src/app/components/ui/button.tsx");const DEFAULT_NOTES_ACTIONS={create:()=>{},update:()=>{},delete:()=>{}},NotesActionsContext=(0,react.createContext)(DEFAULT_NOTES_ACTIONS),NoteForm=({testId,onDone,parentTaskId:primaryTaskId})=>{const[loading,setLoading]=(0,react.useState)(!1),{create}=(0,react.useContext)(NotesActionsContext),{editor,getRteValue}=(0,rte_hook.P)({value:"",editable:!0});if(!editor)return null;const handleSubmit=async()=>{const{title,textContent,tags,contentJSON}=getRteValue();setLoading(!0),create({title,note:textContent||"(no content)",jsonNote:contentJSON,tags,parentTaskId:primaryTaskId}),null==editor||editor.commands.setContent(""),setLoading(!1),onDone()},submitButtonDisabled=!(null==editor?void 0:editor.getHTML().length)||"<p></p>"===(null==editor?void 0:editor.getHTML());return(0,jsx_runtime.jsxs)("div",{"data-testid":testId,children:[(0,jsx_runtime.jsx)(RichTextEditor.A,{testId:"rte-testId",editor,onKeyDown:event=>{"Enter"===event.key&&event.ctrlKey&&handleSubmit()}}),(0,jsx_runtime.jsx)(ui_button.$,{disabled:submitButtonDisabled||loading,onClick:handleSubmit,className:"mt-4",children:"Create"})]})},NoteForm_NoteForm=NoteForm;NoteForm.__docgenInfo={description:"",methods:[],displayName:"NoteForm",props:{testId:{required:!1,tsType:{name:"string"},description:""},parentTaskId:{required:!1,tsType:{name:"string"},description:""}}};var TaskFormModal=__webpack_require__("./src/app/components/TaskFormModal/index.ts");const TaskActions=({children,task})=>{const[addNoteFormOpen,setAddNoteFormOpen]=(0,react.useState)(!1),[taskFormOpen,setTaskFormOpen]=(0,react.useState)(!1),{editTask}=(0,use_edit_task.A)(),closeTaskForm=()=>setTaskFormOpen(!1);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(sheet.cj,{open:addNoteFormOpen,children:(0,jsx_runtime.jsxs)(sheet.h,{side:"right",onCloseClick:()=>setAddNoteFormOpen(!1),showOverlay:!1,onEscapeKeyDown:()=>setAddNoteFormOpen(!1),children:[(0,jsx_runtime.jsx)(sheet.Fm,{children:(0,jsx_runtime.jsx)(sheet.qp,{children:"Add note"})}),(0,jsx_runtime.jsx)(NoteForm_NoteForm,{onDone:()=>setAddNoteFormOpen(!1),parentTaskId:task._id})]})}),(0,jsx_runtime.jsx)(TaskFormModal.A,{editMode:!0,open:taskFormOpen,onDone:closeTaskForm,onClose:closeTaskForm,task}),(0,jsx_runtime.jsxs)(context_menu.tz,{children:[(0,jsx_runtime.jsx)(context_menu.Rc,{children}),(0,jsx_runtime.jsxs)(context_menu.Ip,{className:"w-64",children:[(0,jsx_runtime.jsx)(context_menu.kt,{inset:!0,onClick:()=>setAddNoteFormOpen(!0),children:"Add note"}),task.completed&&(0,jsx_runtime.jsx)(context_menu.kt,{inset:!0,onClick:()=>editTask(task._id,{completed:!1},(()=>setTaskFormOpen(!1))),children:"Undo"}),!task.completed&&(0,jsx_runtime.jsx)(context_menu.kt,{inset:!0,onClick:()=>editTask(task._id,{completed:!0},(()=>setTaskFormOpen(!1))),children:"Complete"}),!task.eventId&&task.isActive&&(0,jsx_runtime.jsx)(context_menu.kt,{inset:!0,onClick:()=>editTask(task._id,{isActive:!1},(()=>setTaskFormOpen(!1))),children:"Deactivate"}),!task.eventId&&!task.isActive&&(0,jsx_runtime.jsx)(context_menu.kt,{inset:!0,onClick:()=>editTask(task._id,{isActive:!0},(()=>setTaskFormOpen(!1))),children:"Activate"}),(0,jsx_runtime.jsx)(context_menu.kt,{inset:!0,onClick:()=>setTaskFormOpen(!0),children:"Edit"}),!!task.eventId&&(0,jsx_runtime.jsx)(context_menu.kt,{inset:!0,onClick:()=>editTask(task._id,{eventId:null}),children:"Remove from event"})]})]})]})};TaskActions.__docgenInfo={description:"",methods:[],displayName:"TaskActions",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""},task:{required:!0,tsType:{name:"intersection",raw:"TaskV2 & {\n  relatedTaskIds: string[];\n  relatedNoteIds: string[];\n}",elements:[{name:"TaskV2"},{name:"signature",type:"object",raw:"{\n  relatedTaskIds: string[];\n  relatedNoteIds: string[];\n}",signature:{properties:[{key:"relatedTaskIds",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}},{key:"relatedNoteIds",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}}]}}]},description:""}}}},"./src/app/components/TaskCard/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>TaskCard_TaskCard});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),card=__webpack_require__("./src/app/components/ui/card.tsx"),badge=__webpack_require__("./src/app/components/ui/badge.tsx"),format=__webpack_require__("./node_modules/date-fns/format.mjs"),use_tags=__webpack_require__("./src/app/utils/hooks/use-tags.tsx"),StaleIndicator=__webpack_require__("./src/app/components/StaleIndicator/index.ts"),core_esm=__webpack_require__("./node_modules/@dnd-kit/core/dist/core.esm.js"),IconProgressCheck=__webpack_require__("./node_modules/@tabler/icons-react/dist/esm/icons/IconProgressCheck.mjs"),IconLayoutSidebarRightExpand=__webpack_require__("./node_modules/@tabler/icons-react/dist/esm/icons/IconLayoutSidebarRightExpand.mjs"),IconCalendar=__webpack_require__("./node_modules/@tabler/icons-react/dist/esm/icons/IconCalendar.mjs"),date=__webpack_require__("./src/app/utils/date/date.ts");const CalendarDateContext=(0,react.createContext)({selectedDate:(0,date.tB)(),setSelectedDate:()=>{}});var tooltip=__webpack_require__("./src/app/components/ui/tooltip.tsx"),dist=__webpack_require__("./node_modules/@radix-ui/react-tooltip/dist/index.mjs"),state_context=__webpack_require__("./src/app/utils/hooks/use-projects/state-context.ts"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.mjs"),TaskActions=__webpack_require__("./src/app/components/TaskActions/index.ts");const TaskCard=({testId,task,dragId,indicateActive})=>{const{data:projects}=(0,state_context.h)(),{data:tags}=(0,use_tags.Ay)(),{setSelectedDate}=(0,react.useContext)(CalendarDateContext),{attributes,listeners,setNodeRef,transform}=(0,core_esm.PM)({id:dragId,disabled:task.completed||!!task.eventId,data:{id:task._id}}),style=transform?{transform:`translate(${transform.x}px, ${transform.y}px)`,position:"fixed",zIndex:999,opacity:.5}:void 0,project=projects.find((p=>p._id===task.projectId)),taskTags=tags.filter((tag=>task.tags.includes(tag._id))),router=(0,navigation.useRouter)();return(0,jsx_runtime.jsx)("div",{"data-testid":testId,children:(0,jsx_runtime.jsx)(TaskActions.d,{task,children:(0,jsx_runtime.jsxs)(card.Zp,{"data-testid":"TaskCard-card-testid",className:`p-0 rounded-md ${task.completed?"opacity-40 line-through":""} `,ref:setNodeRef,style,...listeners,...attributes,children:[(0,jsx_runtime.jsxs)(card.aR,{className:"p-4",children:[(0,jsx_runtime.jsxs)(card.ZB,{"data-testid":"TaskCard-title-testid",className:"font-normal flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{children:task.title}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",children:[indicateActive&&task.isActive&&(0,jsx_runtime.jsx)(IconProgressCheck.A,{size:18,color:"green"}),task.isActive&&(0,jsx_runtime.jsx)(StaleIndicator.A,{date:task.activatedAt||0}),(!!task.relatedTaskIds.length||!!task.relatedNoteIds.length)&&(0,jsx_runtime.jsx)(IconLayoutSidebarRightExpand.A,{"data-testid":"task-info-icon",size:18,onClick:()=>router.push(`/?taskId=${task._id}`,void 0)}),!!task.deadline&&(0,jsx_runtime.jsx)(tooltip.Bc,{children:(0,jsx_runtime.jsx)(tooltip.m_,{delayDuration:0,children:(0,jsx_runtime.jsxs)(dist.k$,{children:[(0,jsx_runtime.jsx)(IconCalendar.A,{size:18,onClick:()=>{setSelectedDate(new Date(task.deadline))}}),(0,jsx_runtime.jsx)(tooltip.ZI,{children:(0,format.GP)(task.deadline,"MM-dd")})]})})})]})]}),!task.completed&&(0,jsx_runtime.jsx)(card.BT,{children:(0,jsx_runtime.jsx)("div",{style:{color:null==project?void 0:project.color},children:null==project?void 0:project.title})})]}),task.description&&!task.completed&&(0,jsx_runtime.jsx)(card.Wu,{className:"pb-4 px-4 text-xs whitespace-pre-wrap muted",children:task.description}),!!taskTags.length&&(0,jsx_runtime.jsx)(card.wL,{className:"p-4",children:(0,jsx_runtime.jsx)("div",{className:"space-x-1",children:taskTags.map((tag=>(0,jsx_runtime.jsx)(badge.E,{variant:"outline",children:tag.title},tag._id)))})})]})})})},TaskCard_TaskCard=TaskCard;TaskCard.__docgenInfo={description:"",methods:[],displayName:"TaskCard",props:{testId:{required:!1,tsType:{name:"string"},description:""},task:{required:!0,tsType:{name:"intersection",raw:"TaskV2 & {\n  relatedTaskIds: string[];\n  relatedNoteIds: string[];\n}",elements:[{name:"TaskV2"},{name:"signature",type:"object",raw:"{\n  relatedTaskIds: string[];\n  relatedNoteIds: string[];\n}",signature:{properties:[{key:"relatedTaskIds",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}},{key:"relatedNoteIds",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}}]}}]},description:""},dragId:{required:!0,tsType:{name:"string"},description:""},indicateActive:{required:!1,tsType:{name:"boolean"},description:""}}}},"./src/app/components/ui/tooltip.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Bc:()=>TooltipProvider,ZI:()=>TooltipContent,k$:()=>TooltipTrigger,m_:()=>Tooltip});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@radix-ui/react-tooltip/dist/index.mjs"),_app_components_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/app/components/utils/index.ts");const TooltipProvider=_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_2__.Kq,Tooltip=_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_2__.bL,TooltipTrigger=_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_2__.l9,TooltipContent=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef((({className,sideOffset=4,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_2__.UC,{ref,sideOffset,className:(0,_app_components_utils__WEBPACK_IMPORTED_MODULE_3__.cn)("z-50 overflow-hidden rounded-md bg-secondary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",className),...props})));TooltipContent.displayName=_radix_ui_react_tooltip__WEBPACK_IMPORTED_MODULE_2__.UC.displayName,TooltipContent.__docgenInfo={description:"",methods:[],props:{sideOffset:{defaultValue:{value:"4",computed:!1},required:!1}}}},"./src/app/utils/mocks/task.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Dq:()=>generateTask,J_:()=>generateCustomTasksList});const generateTask=(i=1,properties)=>({_id:`task${i}`,title:`Task ${i}`,description:`task description ${i}`,completed:!1,isActive:!1,deleted:!1,projectId:"project1",estimate:0,sortOrder:0,event:null,completedAt:0,activatedAt:0,parentTaskId:null,tags:[],createdAt:"2023-05-02T20:40:04.107Z",updatedAt:"2023-05-02T20:40:04.107Z",deadline:null,relatedTaskIds:[],relatedNoteIds:[],...properties}),generateCustomTasksList=taskInfo=>taskInfo.map(((taskProperties,i)=>({...generateTask(i,taskProperties)})))}}]);